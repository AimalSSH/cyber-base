RTO (Retransmission Timeout) - это **время ожидания подтверждения (ACK)**, по истечении которого отправитель считает пакет утерянным и выполняет его повторную передачу.

 Ретрансмиссия (Retransmission) — это повторная передача сетевого пакета данных, который, по мнению отправителя, был утерян или поврежден при первоначальной отправке.

- Система постоянно измеряет, сколько времени проходит между отправкой пакета и получением ACK.
    
- **RTO вычисляется на основе среднего значения RTT и его вариаций (стандартного отклонения).** Он динамически подстраивается под условия сети. Если сеть нестабильна и задержки "прыгают", RTO увеличивается, чтобы не делать ретрансмиссии слишком поспешно.

Типы ретрансмиссий (Retransmissions)
В TCP есть два основных механизма ретрансмиссий:
1. **Ретрансмиссия по таймауту (Timeout-based Retransmission)**
    - **Как работает:** Срабатывает, когда истекает таймер RTO для самого старшего неподтвержденного пакета.
    - **Это "тяжелая артиллерия".** Обычно указывает на **серьезную проблему** в сети (пакет действительно потерялся, большие задержки). После такой ретрансмиссии TCP часто резко снижает скорость передачи (активирует алгоритм медленного старта), чтобы не перегрузить и без того проблемный канал.
2. **Быстрая ретрансмиссия (Fast Retransmit)**
- **Как работает:** Это более оптимизированный механизм. Получатель всегда ACK'иет последний **последовательно принятый** байт данных.

### Почему это важно в кибербезопасности?

Анализ RTO и ретрансмиссий — мощный инструмент диагностики и обнаружения аномалий.

#### 1. Индикатор проблем с сетью и атак

- **Высокий уровень ретрансмиссий** — это ярко-красный флажок для любого администратора.
    
    - **Перегрузка канала:** Слишком много данных, оборудование (роутеры, коммутаторы) сбрасывает пакеты в очередях. Типичный признак DDoS-атаки на пропускную способность.
    - **Нестабильное соединение:** Плохая Wi-Fi-связь, поврежденные кабели, неисправное сетевое оборудование.
    - **Атака на доступность (DoS):** Злоумышленник может намеренно вызывать потерю пакетов (например, атакуя ARP-кеш или настраивая плохой маршрут), что приводит к лавине ретрансмиссий и катастрофическому падению полезной пропускной способности.
        

#### 2. Обход систем защиты (Evasion)

- **Манипуляция таймерами:** Продвинутый злоумышленник, знающий алгоритмы расчета RTT/RTO, может намеренно задерживать ACK-пакеты, чтобы вызвать срабатывание RTO у легитимного отправителя. Это заставляет отправитель снижать скорость передачи (активировать медленный старт), эффективно проводя **атаку на производительность** (Low-rate DoS), которую сложнее обнаружить, чем обычный Flood.
- **Скрытие данных в ретрансмиссиях:** Вредоносное ПО может пытаться прятать свой трафик в потоке ретрансмиссий, надеясь, что системы мониторинения уделяют ему меньше внимания, так как считают его "легитимным" восстановлением потерянных данных.
    

#### 3. Обнаружение нелегитимной активности

- **Аномальное поведение:** Ботнеты, сканеры портов и другие автоматизированные инструменты часто генерируют трафик с нетипичными паттернами.
    
    - Например, сканер, быстро пытающийся установить тысячи соединений, будет получать множество RST-пакетов (сброс) или не получать ответов. Это вызовет лавину ретрансмиссий и таймаутов на стороне сканера, что легко заметить в логах атакуемой системы.
        
- **Сетевые анализаторы (например, Wireshark)** имеют фильтры специально для ретрансмиссий (`tcp.analysis.retransmission`). Их большое количество в трафике — первый признак для начала расследования.
    

#### 4. Fingerprinting (Сбор отпечатков)

Алгоритмы расчета RTO и поведение при ретрансмиссиях могут незначительно отличаться в разных реализациях TCP-стеков (Windows, Linux, macOS). Анализируя эти тонкие различия, система защиты может с большей точностью определить, с каким типом ОС или устройством она имеет дело.

 
 **Как выделены:** Wireshark по умолчанию подсвечивает ретрансмиссии **черным фоном и красным текстом** — их сразу видно в списке.
    
 **Анализ:** В фильтр можно ввести `tcp.analysis.retransmission`. Wireshark имеет мощные аналитические функции в меню `Analyze > Expert Information`, где все ретрансмиссии и таймауты собраны и классифицированы (например, "Fast Retransmission", "Retransmission", "Spurious Retransmission").
    
 **Причина:** Щелкнув по ретрансмиссии, можно посмотреть детали. Например, в анализе будет указано: "This frame is a (suspected) retransmission" и показан номер предыдущего пакета, который был отправлен.